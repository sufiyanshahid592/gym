;(function($){var mor=window.mor={init:function(){this.share();this.initToggles();this.initContentTabs();if($('#register-popup').length==1){this.initNonUserForm();}
this.initMobileNav();this.initChat();},initNonUserForm:function(){var self=this;var tabs=$('#register-popup .tabs li');tabs.click(function(){if(!$(this).is('.on')){var pos=tabs.index(this);tabs.filter('.on').removeClass('on');$(this).addClass('on');$('#register-popup .tab').hide().eq(pos).show().find("input[type='text']:first")[0].focus();}});$('#register-popup form .pw,#register-popup form .image_reg').remove();$('#register-popup .register').submit(function(e){$('#register-popup .error').remove();e.preventDefault();var data=$(this).serialize();$.post('register/ajax',data,function(response){if(response==1){$('#register-popup .tab').hide().eq(2).show();}else{response=eval('('+response+')');for(var el in response.errors){var error=response.errors[el];self.error($("#register-popup .register input[name='"+el+"']"),error,'error');}}});});$('.must-be-logged').click(function(e){if($('#register-popup').length==0){return true;}
e.stopPropagation();e.preventDefault();mor.media.overlay($('#register-popup'));});},error:function(el,text,cls){cls=cls||'error-message';var pos=$(el).position();var width=$(el).width();if(typeof(text)=='object'){for(var i in text){text=text[i];break;}}
var z=this.zIndex(el);var tip=$('<span class="'+cls+'">'+text+'</span>').appendTo('body').css({zIndex:z+1}).fadeIn();if($(el).is('button')){tip.position({my:"center bottom-5",at:"center top",of:el,collision:"none none"});}else{tip.position({my:"center bottom",at:"center top-2",of:el,collision:"none none"});}
$(tip).click(function(){tip.fadeOut(function(){$(this).remove()});});$(el).one('click',function(){tip.fadeOut(function(){$(this).remove()});$(this).parent().removeClass('error');}).one('change',function(){tip.fadeOut(function(){$(this).remove()});$(this).parent().removeClass('error');});$(el).data('error',tip);return tip;},zIndex:function(el){el=$(el);zIndex=0;while(!el.is('body')){var z=parseInt(el.css('zIndex'),10);if(!isNaN(z)&&z>zIndex){zIndex=z;}
el=el.parent();}
return zIndex;},showErrors:function(errors,context){for(var i in errors){var error=errors[i];var el=$(context).find("[name='"+i+"']");if(el.length==0||el.is('[type="hidden"]')){el=$(context).find('button');}
if(!el.is(':visible')){el=el.prev();}
if(el.length>1){el=$(el).eq(0);}
console.log(el);this.error(el,error);}},getUrl:function(button){if(!$(button).is('a')){return false;}
var url=$(button).attr('count-url');if(typeof(url)!='undefined'){return url;}else if($(button).attr('href').split('?').length>1){var parts=$(button).attr('href').split('?')[1].split('&'),keyval;for(var i in parts){keyval=parts[i].split('=');if(keyval[0]=='u'||keyval[0]=='url'){var url=keyval[1];return url;}}}
return window.location.href;},putCount:function(button){var page=this.getUrl(button);var $button=$(button);if($button.is('.facebook')){var url="https://graph.facebook.com/?id="+page+"&callback=?";$.getJSON(url,function(response){var likes=0;if(response.likes){likes+=response.likes;}
if(response.shares){likes+=response.shares;}
$button.attr('attr-count',likes);if(likes>0){$button.find('span').html(likes);}});}else if($button.is('.twitter')){var url='https://cdn.api.twitter.com/1/urls/count.json?url='+page+'&callback=?';$.getJSON(url,function(response){$button.attr('attr-count',response.count?response.count:0);if(response.count){$button.find('span').html(response.count);}});}else if($button.is('.hn')){var url="http://api.thriftdb.com/api.hnsearch.com/items/_search?filter[fields][url][]="+page+'&callback=?';$.getJSON(url,function(response){if(response.results&&response.results[0]){var score=response.results[0]['item']['points'];var id=response.results[0]['item']['id'];if(score>0){$button.find('span').html(score);var url='http://news.ycombinator.com/item?id='+id;$button.attr('href',url);}}});}else if($button.is('.gplus')){var url="index/gplus?url="+page;$.getJSON(url,function(response){if(response.count!=0){$button.find('span').html(response.count);}});}else if($button.is('.linkedin')){var url='https://www.linkedin.com/countserv/count/share?url='+page+'&callback=?';$.getJSON(url,function(response){$button.attr('attr-count',response.count?response.count:0);if(response.count>0){$button.find('span').html(response.count);}});}},share:function(){var self=this;$('.socialb').each(function(){var button=this;self.putCount(button);});$('.socialb.twitter,.socialb.facebook').click(function(e){e.preventDefault();var newwindow=window.open($(this).attr('href'),'sharing','height=480,width=600');if(window.focus){newwindow.focus();}});$('.social-buttons .share-link a').click(function(e){e.stopPropagation();e.preventDefault();$(this).parent().addClass('active');var link=$(this).parent().find('input');link[0].focus();link[0].select();});$('.social-buttons .share-link input').blur(function(){$(this).parent().removeClass('active');});},initMobileNav:function(){$("#header .show-menu").click(function(){$("#header .links").toggle();});},initToggles:function(){$('.toggle').click(function(){$(this).find('input[type="radio"]').not(':checked').prop("checked",true);$(this).find('input[type="radio"]').change();$(this).toggleClass('on').toggleClass('off');});},initContentTabs:function(){$(".container-tabs li a").click(function(){var tab=$(this).attr('href');$(this).parent().parent().find('.selected').removeClass('selected');$(this).parent().addClass('selected');$(".container-tab.active").removeClass('active');$(tab+".container-tab").addClass('active');return false;});},reviewPopup:function(){var popup=$("#please-review");if(popup.length==1){popup.find('.close').click(function(){var width=360;popup.animate({"right":"-"+width+"px"},function(){$(this).hide();});var id=$('#please-review').attr('attr-id');$.get("user/review/close");});window.setTimeout(function(){popup.animate({"right":0});},3000);}},abActivate:function(test){$.get('ab/activate',{test:test});},form:{validate:function(form,rules,callback){var self=this;$(form).data('rules',rules);var next=function(){if($(form).find('.error').length>0){self.resetButton(form);self.scrollToError();return false;}
if(typeof(callback)=='function'){callback();}else{$(form)[0].submit();}}
$(form).find("input,select").focus(function(){$(this).parent().find('.error-message').remove();}).blur(function(){self.isValid(this);});$(form).submit(function(e){e.stopPropagation();e.preventDefault();var button=$(this).find("button[type='submit']");var html=button.data('html');if(typeof(html)=='undefined'||html!=''){button.data('html',button.html());button.css('min-width',button.outerWidth()).prop('disabled',true).html('Processing <span class="spinner"></span>');}
$(this).find("input,select").each(function(){if($(this).parent().is('.valid')||$(this).is(':hidden')){return;}else if(!$(this).parent().is('.error')&&$(this).data('loading')!==true){self.isValid(this);}});if($(form).is('.loading')){var interval=window.setInterval(function(){if(!$(form).is('.loading')){window.clearInterval(interval);next();}},50);}else{next();}});},isValid:function(el){var name=$(el).attr('attr-name');name=name||$(el).attr('name');if(typeof(name)=='undefined'||name==''){name=$(el).attr('class');if(typeof(name)=='undefined'){return true;}
var parts=name.split(' ');if(parts.length>1){for(var i in parts){if(parts[i]=='text'||parts[i]=='number'){delete(parts[i]);}}}
name=parts.join('');}
var rules=$(el).parents('form').data('rules');if(typeof(rules)=='undefined'||typeof(rules[name])=='undefined'){return true;}
var validation=rules[name];if(typeof(validation)=='function'){validation.call(this,el);}else if(validation){for(var validator in validation){var msg=validation[validator];var valid=this.validators[validator].call(this,$(el).val(),el,msg);}
if(typeof(valid)!='undefined'){return this.result(valid,el,msg);}}},result:function(valid,el,msg){if(valid){$(el).parent().removeClass('error').addClass('valid').find('.spinner').remove();}else if(msg){this.showError(msg,el);return false;}else{$(el).parent().removeClass('valid').find('label').append('<span class="spinner dark-spin"></span>');return false;}},showError:function(msg,el){$(el).parent().removeClass('valid').addClass('error').find('.spinner').remove();mor.error(el,msg);},scrollToError:function(){var error=$(".error-message");if(error.length==0){return;}
var to=error.eq(0).offset().top-90;var scrolled=$('html').prop('scrollTop');if(to-scrolled>500||to-scrolled<0){$('html,body').animate({scrollTop:to},600);}},validators:{Email:function(value,el,msg){var self=this;var url=$(el).attr('attr-target');var form=$(el).parents('form').addClass('loading');$(el).parent().append('<span class="spinner"></span>');$(el).data('loading',true);$.get(url,{email:value},function(response){$(el).data('loading',false);if(response==2){self.result(false,el,'Please enter valid Email address');}else if(response==1){self.result(false,el,msg);}else{self.result(true,el);}
form.removeClass('loading');});},Card:function(value,el,msg){if(typeof(Stripe)!='undefined'){return Stripe.card.validateCardNumber(value);}else{if($.payment.validateCardNumber(value)){var form=$(el).parents('form');if(form.length==1){var input=form.find("input[name='card_brand']");if(input.length==0){input=$('<input type="hidden" name="card_brand" />').appendTo(form);}
input.val($.payment.cardType(value));}
return true;}
return false;}},Expiry:function(value,el,msg){if(typeof(Stripe)!='undefined'){return Stripe.card.validateExpiry($(".card-expiry").val());}else{return $.payment.validateCardExpiry($(".card-expiry").payment('cardExpiryVal'));}},NotEmpty:function(value,el,msg){return value!='';}},resetButton:function(form){var button=$(form).find("button[type='submit']");button.attr('disabled',false).data('disabled',false);if(button.data('html')!=''){button.html(button.data('html'));}}},debug:function(text){if($('#debug').length==0){$('<div id="debug"></div>').appendTo('body');}
var debug=$('#debug');debug.append(text+'<br />');},fp:function(fp){var params={fp:fp};var visitId=false;if(storageAvailable('localStorage')){var visitId=localStorage.getItem('visit_id');if(visitId){params['visit_id']=visitId;}}
$.post('visits/fp',params,function(serverVisitId){if(storageAvailable('localStorage')){localStorage.setItem('visit_id',serverVisitId);}});},initChat:function(){if($('.helpscout-placeholder').length==1){var loaded=false;var load=function(){if(loaded){return;}
loaded=true;loadHelpScout();var el=this;window.setTimeout(function(){$(el).remove();},1000);};$('.helpscout-placeholder').hover(function(){load();});window.setTimeout(function(){load();},5000);}}};})(jQuery);jQuery(document).ready(function(){mor.init();});function storageAvailable(type){var storage;try{storage=window[type];var x='__storage_test__';storage.setItem(x,x);storage.removeItem(x);return true;}
catch(e){return e instanceof DOMException&&(e.code===22||e.code===1014||e.name==='QuotaExceededError'||e.name==='NS_ERROR_DOM_QUOTA_REACHED')&&(storage&&storage.length!==0);}}
var Client={viewportWidth:function(){return self.innerWidth||(document.documentElement.clientWidth||document.body.clientWidth);},viewportHeight:function(){return self.innerHeight||(document.documentElement.clientHeight||document.body.clientHeight);},viewportSize:function(){return{width:this.viewportWidth(),height:this.viewportHeight()};}};window.log=function(name,msg){var debug=$('.debugger');if(debug.length==0){debug=$('<div class="debugger"></div>').appendTo($('body'));}
var el=debug.find('#'+name);if(el.length==0){el=$('<span id="'+name+'"></span>').appendTo(debug);}
el.html(name+': '+msg);};function round(value,precision,mode){var m,f,isHalf,sgn;precision|=0;m=Math.pow(10,precision);value*=m;sgn=(value>0)|-(value<0);isHalf=value%1===0.5*sgn;f=Math.floor(value);if(isHalf){switch(mode){case'PHP_ROUND_HALF_DOWN':value=f+(sgn<0);break;case'PHP_ROUND_HALF_EVEN':value=f+(f%2*sgn);break;case'PHP_ROUND_HALF_ODD':value=f+!(f%2);break;default:value=f+(sgn>0);}}
return(isHalf?value:Math.round(value))/m;}
(function(doc){var write=doc.write;doc.write=function(q){if(/docwriteregexwhitelist/.test(q))write.apply(doc,arguments);};})(document);;;(function($){mor.media=mor.media||{};$.extend(mor.media,{events:function(container){var self=this;$('<div class="popup_overlay"><div id="media_container"></div><a class="next" title="Next">&nbsp;</a>'
+'<a class="prev" title="Previous">&nbsp;</a><a class="close"></a></div>').appendTo('body');$('.popup_overlay a.close').click(function(){self.close($(this).parents('.popup_overlay'));});},showimage:function(src,paginate){var self=this;var largeImage=document.createElement('img');$('#media_container').html('<img src="images/loading.gif" />');var popup=$('#media_container').parents('.popup_overlay');this.overlay(popup);if(paginate==true){popup.addClass('paginate');}else{popup.removeClass('paginate');}
$(largeImage).bind('load',function(){$('#media_container').html(largeImage);var w=$(window);if($(largeImage).attr('width')>w.width()-100||$(largeImage).attr('height')>w.height()-100){if($(largeImage).attr('width')/$(largeImage).attr('height')>w.width()/w.height()){$('#media_container img').width(w.width()-145);}else{$('#media_container img').height(w.height()-140);}}
var popup=$('#media_container').parents('.popup_overlay');self.overlay(popup);});largeImage.src=src;},overlay:function(element){this.center(element);if($('#overlay').length==0){var overlay=$('<div id="overlay"></div>').appendTo('body');var self=this;overlay.click(function(e){e.stopPropagation();self.close(element);});}},center:function(element){var display=$(element).css('display');$(element).show();var width=$(element).outerWidth();var height=$(element).outerHeight();if((height>=$(window).height()||width>=$(window).width())&&$(window).width()<600&&!$(element).is('.zoom-box')){var styles={'position':'fixed','margin-left':'auto','margin-top':'auto','margin-right':'auto','margin-bottom':'auto','left':0,'top':0,'right':0,'border-radius':0,'bottom':0,'overflowY':'auto','overflowX':'hidden'};}else{var wH=$(window).height();var wW=$(window).width();var top=wH>height?(height/2)*-1:0;var left=wW>width?(width/2)*-1:0;var styles={'position':'fixed','marginLeft':left,'marginTop':top,'top':top==0?'0':'50%','left':left==0?'0':'50%'};if(top==0){styles['overflowY']='auto';styles['maxHeight']='100%';styles['overflowX']='hidden';}
if(top==0){styles['top']=0;}
if(left==0){styles['left']=0;}}
$(element).css(styles).fadeIn(300);},altCenter:function(element){var display=$(element).css('display');$(element).show();var width=$(element).outerWidth();var height=$(element).outerHeight();if((height>=$(window).height()||width>=$(window).width())&&$(window).width()<600&&!$(element).is('.zoom-box')){var styles={'position':'fixed','margin-left':0,'margin-top':0,'left':0,'top':0,'right':0,'bottom':0,'overflow':'auto'};}else{var wH=$(window).height();var wW=$(window).width();var top=(wH-height)/2;top=top<0?0:top;var left=(wW-width)/2;left=left<0?0:left;var styles={'position':'fixed','left':left,'top':top,'bottom':top==0?0:'auto','right':left};}
$(element).css(styles).fadeIn(300);},close:function(popup){var self=this;$(popup).fadeOut(200,function(){$('#overlay').remove();var video=$(popup).find('.video-wrapper iframe');if(video.length>0){video.each(function(){if($(this).attr('src').indexOf('youtube.com')!=-1){var id=Math.random().toString(36).substring(7);$(this).parent().attr('id',id);callPlayer(id,'pauseVideo');}});}});if(popup.data('onclose')){var cb=popup.data('onclose');cb.call();}},compress:function(image,width){var dataURLToBlob=function(dataURL){var BASE64_MARKER=';base64,';if(dataURL.indexOf(BASE64_MARKER)==-1){var parts=dataURL.split(',');var contentType=parts[0].split(':')[1];var raw=parts[1];return new Blob([raw],{type:contentType});}
var parts=dataURL.split(BASE64_MARKER);var contentType=parts[0].split(':')[1];var raw=window.atob(parts[1]);var rawLength=raw.length;var uInt8Array=new Uint8Array(rawLength);for(var i=0;i<rawLength;++i){uInt8Array[i]=raw.charCodeAt(i);}
return new Blob([uInt8Array],{type:contentType});}
var elem=document.createElement('canvas');var ratio=width/image.width;elem.width=width;var height=image.height*ratio;elem.height=height;var ctx=elem.getContext('2d');ctx.drawImage(image,0,0,width,height);var dataUrl=elem.toDataURL('image/jpeg',1);var resizedImage=dataURLToBlob(dataUrl);image.src=dataUrl;return resizedImage;},});function callPlayer(frame_id,func,args){if(window.jQuery&&frame_id instanceof jQuery)frame_id=frame_id.get(0).id;var iframe=document.getElementById(frame_id);if(iframe&&iframe.tagName.toUpperCase()!='IFRAME'){iframe=iframe.getElementsByTagName('iframe')[0];}
if(!callPlayer.queue)callPlayer.queue={};var queue=callPlayer.queue[frame_id],domReady=document.readyState=='complete';if(domReady&&!iframe){if(queue)clearInterval(queue.poller);}else if(func==='listening'){if(iframe&&iframe.contentWindow){func='{"event":"listening","id":'+JSON.stringify(''+frame_id)+'}';iframe.contentWindow.postMessage(func,'*');}}else if((!queue||!queue.ready)&&(!domReady||iframe&&!iframe.contentWindow||typeof func==='function')){if(!queue)queue=callPlayer.queue[frame_id]=[];queue.push([func,args]);if(!('poller'in queue)){queue.poller=setInterval(function(){callPlayer(frame_id,'listening');},250);messageEvent(1,function runOnceReady(e){if(!iframe){iframe=document.getElementById(frame_id);if(!iframe)return;if(iframe.tagName.toUpperCase()!='IFRAME'){iframe=iframe.getElementsByTagName('iframe')[0];if(!iframe)return;}}
if(e.source===iframe.contentWindow){clearInterval(queue.poller);queue.ready=true;messageEvent(0,runOnceReady);while(tmp=queue.shift()){callPlayer(frame_id,tmp[0],tmp[1]);}}},false);}}else if(iframe&&iframe.contentWindow){if(func.call)return func();iframe.contentWindow.postMessage(JSON.stringify({"event":"command","func":func,"args":args||[],"id":frame_id}),"*");}
function messageEvent(add,listener){var w3=add?window.addEventListener:window.removeEventListener;w3?w3('message',listener,!1):(add?window.attachEvent:window.detachEvent)('onmessage',listener);}};if(typeof($.datepicker)!='undefined'){const checkOffset=$.datepicker._checkOffset;$.extend($.datepicker,{_checkOffset:function(inst,offset,isFixed){if(!isFixed){return checkOffset.apply(this,arguments);}
var isRTL=this._get(inst,"isRTL");var obj=inst.input[0];while(obj&&(obj.type==="hidden"||obj.nodeType!==1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"];}
var rect=obj.getBoundingClientRect();var viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop()),dpHeight=inst.dpDiv.outerHeight();var viewWidth=$(window).width();var dpWidth=inst.dpDiv.outerWidth();var css={top:viewHeight<rect.top+rect.height+dpHeight?rect.top-dpHeight:rect.top+rect.height};var left=rect.left;if(left+dpWidth>viewWidth){css['right']=0;css['left']='auto';}else{css['left']=rect.left;}
return css;}});}})(jQuery);;;(function($){$.extend($.fn,{placeholderSupport:null,placeholder:function(){var createPlaceholder=function(input){var placeholder=$(input).attr('placeholder');if(placeholder!=''){var placeholder=$('<span class="placeholder_span">'+placeholder+'</span>').appendTo($(input).parent());var pos=$(input).position();placeholder.css({top:pos.top,left:pos.left});if($(input).val()!=''){placeholder.hide();}
placeholder.click(function(){$(this).hide();input.focus();});$(input).focus(function(){placeholder.hide();}).blur(function(){if($(this).val()==''){placeholder.show();}});}}
if(this.placeholderSupport==null){var i=document.createElement('input');this.placeholderSupport=('placeholder'in i);}
if(this.placeholderSupport==false){if(!$(this).is('input')){$(this).find("input[type='text'],input[type='password']").each(function(){createPlaceholder(this);});}else{createPlaceholder(this);}}}});})(jQuery);;;(function(){mor.main={init:function(){var self=this;$('#header .showmenu').click(function(e){e.stopPropagation();$('#menu').toggle();});$('#header .front-desk,.subnav .front-desk').click(function(){mor.media.overlay($('#front-desk-popup'));if($('#front-desk-popup input').length>0){$('#front-desk-popup input').focus();}});$('#front-desk-popup .activate').click(function(){window.location='/manager/frontdesk';});$('input.error').focus(function(){$(this).removeClass('error');});$('#front-desk-popup form').submit(function(e){e.preventDefault();var button=$('#front-desk-popup button');if(button.data('sending')==1){return false;}
button.data('sending',1);button.data('html',button.html());button.html('Checking <span class="spinner"></span>');$.post('manager/frontdesk/exit',$(this).serialize(),function(response){if(response==1){button.html('Success!');window.setTimeout(function(){window.location='/manager';},500);}else{mor.error($("#front-desk-popup input"),"Incorrect password");button.html(button.data('html'));button.data('sending','');}});});$('.manager-mode #header .selector em').click(function(e){e.stopPropagation();var menu=$(this).next('ul');menu.removeClass('near-location').css('left','auto');if(menu.is(':visible')){menu.hide();}else{menu.show();}});$('.manager-mode .section-header em.location').click(function(e){e.stopPropagation();var menu=$('#header .selector .location-selector');menu.addClass('near-location');var offset=$(this).offset().left;if(menu.is(':visible')){menu.hide();}else{menu.show().css('left',offset);}});$('.manager-mode #logo').click(function(e){e.preventDefault();e.stopPropagation();$('#header .selector .location-selector').removeClass('near-location').css('left','auto').toggle();});if($('.section-header .subnav').length==1){this.initSubnav();}
$(body).click(function(){$('#header .usermenu ul').hide();$('#header .selector .location-selector').css({'display':'','left':''});if($('#header .showmenu').is(':visible')){$('#menu').hide();}
$('.popup.actions').hide();$('.show-settings.active').removeClass('active');});this.initRadios();if($('.filters').length==1){this.initFilters();}
if($('.table-container').length==1){this.initTables();}
if($('.pie-chart').length>0){var graph=$('.revenue');if(graph.width()<graph.prop('scrollWidth')){var offset=(graph.prop('scrollWidth')-graph.width())/2;graph.scrollLeft(offset);}
$('.pie-chart').each(function(){if($(this).attr('attr-percent')>0){self.svgProgress(this);}});}
$('.show-settings').click(function(e){e.stopPropagation();$('.show-settings.active').removeClass('active');$('.popup.actions').hide();$(this).parent().find('.popup:first').show();$(this).addClass('active');});this.initMultiDropdown();},initRadios:function(){$('.radio li').click(function(){var list=$(this).parent();list.find('.selected').removeClass('selected');$(this).addClass('selected');$(this).find("input[type='radio']").prop('checked',true);});},initMultiDropdown:function(context){context=typeof(context)!='undefined'?context:'.multi-dropdown';if(context=='.multi-dropdown'){$(".multi-dropdown").click(function(e){e.stopPropagation();});$(window).click(function(){$('.multi-dropdown .dropdown-menu').hide();});}
$(context).find("em").click(function(e){$(this).parent().find('.dropdown-menu').toggle();});$(context).find("input[type='checkbox']").change(function(){var menu=$(this).parents('.dropdown-menu');var checked=menu.find("input[type='checkbox']:checked").length;var em=menu.prev('em');em.html(checked==0?em.attr('attr-default'):('<b>'+checked+'</b> selected'));});},avatar:function(photo,name){var parts=name.split(' ');var initials=parts[0].substring(0,1)+(parts.length>1?parts[1].substring(0,1):'');var html='<span class="avatar color'+this.getColor(name)+'">';if(photo!=''){html+='<img alt="'+initials+'" src="'+photo+'" />';}else{html+=initials;}
html+='</span>';return html;},getColor:function(str){var characters={'a':1,'b':2,'c':3,'d':4,'e':5,'f':6,'g':7,'h':8,'i':1,'j':2,'k':3,'l':4,'m':5,'n':6,'o':7,'p':8,'q':1,'r':2,'s':3,'t':4,'u':5,'v':6,'w':7,'x':8,'y':1,'z':2};var first=str.substring(0,1).toLowerCase();return characters[first];},initSubnav:function(){var addScroll=function(nav){var scrollWidth=$(nav).prop('scrollWidth');var width=$(nav).width();if(scrollWidth>width+5){$(nav).addClass('rightshadow');}else{$(nav).removeClass('rightshadow');}
$(nav).scroll(function(e){var el=$(e.target);var maxScrollLeft=el.prop('scrollWidth')-el.prop('clientWidth');var left=el.prop('scrollLeft');if(left+1>maxScrollLeft){el.removeClass('rightshadow');}else{el.addClass('rightshadow');}
if(left>0){el.addClass('leftshadow');}else{el.removeClass('leftshadow');}});};$('.subnav').each(function(){var nav=$(this);var selected=nav.find('.selected');addScroll(nav);if(selected.length==1){if(nav.width()<selected.offset().left+selected.width()){nav.scrollLeft(selected.offset().left);}}});},initTables:function(){var addScroll=function(){var scrollWidth=$('.table-container table').prop('scrollWidth');var width=$('.table-container').width();if(scrollWidth>width){$('.table-container').addClass('rightshadow');}else{$('.table-container').removeClass('rightshadow');}};addScroll();$(window).resize(function(){addScroll();});$('.table-container').scroll(function(e){var el=$(e.target);var maxScrollLeft=el.prop('scrollWidth')-el.prop('clientWidth');var left=el.prop('scrollLeft');if(left+1>maxScrollLeft){el.removeClass('rightshadow');}else{el.addClass('rightshadow');}
if(left>0){el.addClass('leftshadow');}else{el.removeClass('leftshadow');}});},initFilters:function(){$('.show-filters').click(function(e){if(!$(this).is('.active')){e.stopPropagation();$(this).addClass('active');$('.filter-popup').fadeIn(300);var top=$(this).position().top;top+=$(this).outerHeight()+13;$('.filter-popup').css({top:top});}});$('.filter-popup .close').click(function(){$('.filter-popup').fadeOut(300);$('.show-filters').removeClass('active');});$('.filter-popup .reset').click(function(){$(".filter-popup input:not([type='checkbox']):not([type='radio']),.filter-popup select").each(function(){$(this).val('');});});$('.filter-popup').click(function(e){e.stopPropagation();$(this).find(".dropdown-menu").hide();});$('.filters .export').click(function(e){e.stopPropagation();$('.export-popup').toggle().position({of:this,at:"right bottom",my:"right top+10"});});$('.filters .icon-search').click(function(){if($('.search').is('.visible')){if($('.search .text').val()!=''){$('.search .text').val('');$('.members form').submit();}else{$('.search').removeClass('visible');}}else{$('.search').addClass('visible');$('.search .text').focus();}});$('.filters .search .text').keyup(function(){if($(this).val()!=''){$(this).parent().addClass('value');}else{$(this).parent().removeClass('value');}});$('.filters .search .text').blur(function(){if($(this).val()==''){$('.search').removeClass('visible');}});$(window).click(function(e){if($(e.target).parents('#container').length==1){$('.filter-popup').fadeOut(300);$('.show-filters').removeClass('active');}
$('.export-popup').hide();});},initDatepicker:function(direction,ranges){direction=direction?direction:'left';ranges=ranges?ranges:{'Next 14 Days':[moment(),moment().add(13,'days')],'Next 30 Days':[moment(),moment().add(29,'days')],'This Month':[moment().startOf('month'),moment().endOf('month')],'Next Month':[moment().add(1,'month').startOf('month'),moment().add(1,'month').endOf('month')]};var rangeInput=$('.range');if(rangeInput.length>0){var format=$("#range-date-format").val();rangeInput.daterangepicker({locale:{format:format},ranges:ranges,showDropdowns:true,alwaysShowCalendars:true,opens:direction,autoApply:true,autoUpdateInput:false});rangeInput.on('apply.daterangepicker',function(ev,picker){$(this).val(picker.startDate.format(format)+' - '+picker.endDate.format(format));});rangeInput.on('cancel.daterangepicker',function(ev,picker){$(this).val('');});return rangeInput;}},svgProgress:function(svg){var progress=$(svg).attr('attr-percent');var RADIUS=50;var CIRCUMFERENCE=2*Math.PI*RADIUS;var dashoffset=CIRCUMFERENCE*(1-progress);var progressValue=$(svg).find('.progress-value');progressValue.css({"stroke-dasharray":CIRCUMFERENCE,"stroke-dashoffset":CIRCUMFERENCE});progressValue.animate({"stroke-dashoffset":dashoffset},300);},initBulkActions:function(key){var self=this;$('.activate-selection').click(function(){$(this).hide();$('.bulk-ops table').addClass('show-cb');$(this).next('.selecting').css('display','inline-block');Cookies.set(key,1);});var cancelSelection=function(){$('.mass-select .selecting').hide();$('.mass-select .activate-selection').show();$('.bulk-ops table').removeClass('show-cb');$(".bulk-ops table input[type='checkbox']:checked").each(function(){$(this).prop('checked',false);});sessionStorage.removeItem(key);if(typeof(Cookies)!='undefined'){Cookies.set(key,0);}};$('.cancel-mass').click(function(){cancelSelection();});$(".bulk-ops table input[type='checkbox']").click(function(){self.storeSelections(key);});$('.mass-select .select-all').click(function(){var total=$(".bulk-ops table input[type='checkbox']").length;var checked=$(".bulk-ops table input[type='checkbox']:checked").length;var cb=$(this).find("input[type='checkbox']");if(checked==total){$(".bulk-ops table input[type='checkbox']").prop('checked',false);cb.prop('checked',false);}else{$(".bulk-ops table input[type='checkbox']").prop('checked',true);cb.prop('checked',true);}
self.storeSelections(key);});$('.mass-select .apply-selection').click(function(e){e.stopPropagation();var checked=sessionStorage.getItem(key);if(typeof(checked)=='string'&&checked!=''){var ids=checked.split(',');var popup=$('.mass-operations');popup.find('.count').html(ids.length);var input=popup.find("input[name='ids']");popup.find('.operation').hide();popup.find('.active').hide();popup.find("select[name='operation']").val('');input.val(checked);mor.media.overlay(popup);}});$('.mass-operations .close').click(function(){mor.media.close($('.mass-operations'));});$('.mass-operations').submit(function(e){e.preventDefault();var button=$('.mass-operations .operation:visible button');button.data('html',button.html());button.html('Working <span class="spinner"></span>');var data=$('.mass-operations').serialize();$.post($(this).attr('action'),data,function(response){button.html('Done!');window.setTimeout(function(){mor.media.close($('.mass-operations'));cancelSelection();button.html(button.data('html'));window.location.reload();},1500);});});var checked=sessionStorage.getItem(key);if(typeof(checked)=='string'&&checked!=''){var ids=checked.split(',');for(var i in ids){var id=ids[i];var cb=$("input[type='checkbox'][value='"+id+"']");if(cb.length==1){cb.prop('checked',true);}}
var total=$("table input[type='checkbox']").length;var checked=$("table input[type='checkbox']:checked").length;if(ids.length>0){$('.apply-selection').removeClass('disabled');var counter=$('.mass-select .counter');counter.html(ids.length+' <span class="hide">'+counter.attr('attr-counter')+'</span>').css('display','inline-block');}
if(total==checked){$(".mass-select .select-all input[type='checkbox']").prop('checked',true);}}else{cancelSelection();}},storeSelections:function(key){var checked=sessionStorage.getItem(key);var ids=[];if(typeof(checked)=='string'&&checked!=''){ids=checked.split(',');}
$(".bulk-ops table input[type='checkbox']").each(function(){var val=$(this).val();var index=ids.indexOf(val);if($(this).prop('checked')){if(index==-1){ids.push(val);}}else{if(index>-1){ids.splice(index,1);}}});var counter=$('.mass-select .counter');if(ids.length>0){$('.mass-select .apply-selection').removeClass('disabled');counter.html(ids.length+' <span class="hide">'+counter.attr('attr-counter')+'</span>').css('display','inline-block');}else{$('.mass-select .apply-selection').addClass('disabled');counter.hide();}
sessionStorage.setItem(key,ids);}};$(document).ready(function(){mor.main.init();});})();